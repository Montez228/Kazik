<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>–ó–±—ñ—Ä: –ó–∞—Ä—è–¥–∂–µ–Ω—ñ –Ω–∞ –õ–∏–º–æ–Ω üçãüá∫üá¶</title>
    <!-- Tailwind CSS v3 via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Supabase JS via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Canvas Confetti via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            background: radial-gradient(circle at top right, #1e1b4b 0%, #020617 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .neon-border {
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.4), inset 0 0 5px rgba(168, 85, 247, 0.2);
            border: 1px solid rgba(168, 85, 247, 0.5);
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.8), 0 0 20px rgba(168, 85, 247, 0.4);
        }

        .glass {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .slot-container {
            perspective: 1000px;
        }

        .reel {
            transition: transform 0.1s linear;
        }

        .blur-effect {
            filter: blur(4px);
        }

        @keyframes bounce-win {

            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0) scale(1);
            }

            40% {
                transform: translateY(-20px) scale(1.1);
            }

            60% {
                transform: translateY(-10px) scale(1.05);
            }
        }

        .animate-win {
            animation: bounce-win 1s ease infinite;
        }
    </style>
</head>

<body class="flex flex-col items-center">

    <!-- Auth Screen -->
    <div id="auth-screen" class="fixed inset-0 z-50 flex items-center justify-center p-6 bg-slate-950 text-center">
        <div class="glass p-12 rounded-[3rem] w-full max-w-md neon-border shadow-[0_0_50px_rgba(234,179,8,0.2)]">
            <h1 class="text-4xl font-black italic text-yellow-400 mb-2 tracking-tighter uppercase leading-tight">
                –ó–∞—Ä—è–¥–∂–µ–Ω—ñ<br>–Ω–∞ –õ–∏–º–æ–Ω</h1>
            <p class="text-blue-400 font-bold tracking-widest text-[10px] mb-10 uppercase italic">–ö—Ä—É—Ç–∏–º–æ –ø–æ–¥–∞—Ä—É–Ω–∫–∏ ‚Äî
                –¥–æ–ø–æ–º–∞–≥–∞—î–º–æ –ó–°–£ üçãüá∫üá¶</p>

            <div class="relative mb-8">
                <input type="text" id="username-input" placeholder="–í–í–ï–î–Ü–¢–¨ –ù–Ü–ö–ù–ï–ô–ú"
                    class="w-full bg-slate-900/50 border border-white/10 p-5 rounded-2xl outline-none focus:border-purple-500 text-center text-xl font-black transition-all placeholder:text-slate-600">
            </div>

            <button onclick="handleLogin()" id="login-btn"
                class="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 text-slate-950 font-black p-5 rounded-2xl hover:scale-[1.02] active:scale-95 transition-all text-sm shadow-[0_10px_30px_rgba(234,179,8,0.3)] uppercase">
                –£–≤—ñ–π—Ç–∏ —Ç–∞ –Ω–∞–±–ª–∏–∑–∏—Ç–∏ –ø–µ—Ä–µ–º–æ–≥—É
            </button>
            <p id="auth-status" class="mt-4 text-xs text-slate-500 font-bold"></p>
        </div>
    </div>

    <!-- Main Game Section -->
    <div id="game-screen" class="hidden w-full max-w-7xl p-4 md:p-10 flex flex-col items-center min-h-screen">
        <div class="w-full flex justify-between items-center mb-6 md:mb-10 gap-4">
            <div class="shrink-0">
                <h1 class="text-3xl md:text-5xl font-black italic text-yellow-400 tracking-tighter">–õ–ò–ú–û–ù</h1>
                <p class="text-[8px] md:text-[10px] text-blue-400 font-bold tracking-widest uppercase">Drive for Victory
                    v3.0</p>
            </div>

            <div
                class="flex items-center gap-3 md:gap-6 glass px-3 md:px-8 py-2 md:py-4 rounded-2xl md:rounded-[2rem] border border-white/10 shadow-xl overflow-hidden">
                <div class="hidden sm:block text-right">
                    <p class="text-[8px] text-slate-500 font-bold uppercase tracking-tighter mb-1">–ì—Ä–∞–≤–µ—Ü—å</p>
                    <p id="display-username"
                        class="font-black text-purple-400 text-sm md:text-xl tracking-tight truncate max-w-[80px] md:max-w-[120px]">
                        ---</p>
                </div>
                <div class="hidden sm:block h-10 w-[1px] bg-white/10"></div>
                <div class="text-right">
                    <p class="text-[8px] text-slate-500 font-bold uppercase tracking-tighter mb-1">–°–ø—ñ–Ω–∏</p>
                    <p id="display-spins" class="font-black text-blue-400 text-lg md:text-2xl tracking-tighter">0</p>
                </div>
                <div class="h-8 w-[1px] bg-white/10"></div>
                <div class="text-right">
                    <p class="text-[8px] text-slate-500 font-bold uppercase tracking-tighter mb-1">–ë–∞–ª–∏</p>
                    <p id="display-points" class="font-black text-yellow-400 text-lg md:text-2xl tracking-tighter">0</p>
                </div>
                <div class="h-8 w-[1px] bg-white/10"></div>
                <button onclick="logout()"
                    class="flex items-center gap-2 px-2 md:px-4 py-1.5 md:py-2 border border-white/10 hover:border-red-500/50 hover:bg-red-500/10 rounded-xl md:rounded-2xl transition-all text-slate-400 hover:text-red-400 group shrink-0"
                    title="–í–∏–π—Ç–∏">
                    <span class="text-[9px] font-bold uppercase tracking-wider hidden md:block">–í–∏–π—Ç–∏</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="group-hover:translate-x-1 transition-transform">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                        <polyline points="16 17 21 12 16 7" />
                        <line x1="21" y1="12" x2="9" y2="12" />
                    </svg>
                </button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-10 w-full mb-20">

            <!-- Leaderboard (Left) -->
            <div class="lg:col-span-1 order-2 lg:order-1">
                <div class="glass p-8 rounded-[2.5rem] border border-white/5 h-full relative">
                    <h3
                        class="text-2xl font-black mb-8 italic text-purple-400 uppercase tracking-tighter flex items-center gap-2">
                        <span>üèÜ</span> TOP-10
                    </h3>
                    <div id="leaderboard-list" class="space-y-3">
                        <div class="text-center text-slate-600 animate-pulse py-10 font-bold">–û–ù–û–í–õ–ï–ù–ù–Ø...</div>
                    </div>
                </div>
            </div>

            <!-- Slot Center -->
            <div class="lg:col-span-3 order-1 lg:order-2 flex flex-col items-center">
                <div
                    class="glass p-10 md:p-14 rounded-[4rem] border-4 border-purple-500/20 bg-slate-950/80 relative flex flex-col items-center shadow-2xl w-full">

                    <div class="flex gap-2 md:gap-8 mb-8 md:mb-12 slot-container">
                        <div
                            class="w-20 h-32 md:w-40 md:h-60 bg-slate-900 rounded-2xl md:rounded-3xl flex items-center justify-center text-5xl md:text-8xl border border-white/5 relative overflow-hidden shadow-inner">
                            <div id="reel-1" class="reel">üçã</div>
                            <div
                                class="absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-black/60 pointer-events-none">
                            </div>
                        </div>
                        <div
                            class="w-20 h-32 md:w-40 md:h-60 bg-slate-900 rounded-2xl md:rounded-3xl flex items-center justify-center text-5xl md:text-8xl border border-white/5 relative overflow-hidden shadow-inner">
                            <div id="reel-2" class="reel">üçã</div>
                            <div
                                class="absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-black/60 pointer-events-none">
                            </div>
                        </div>
                        <div
                            class="w-20 h-32 md:w-40 md:h-60 bg-slate-900 rounded-2xl md:rounded-3xl flex items-center justify-center text-5xl md:text-8xl border border-white/5 relative overflow-hidden shadow-inner">
                            <div id="reel-3" class="reel">üçã</div>
                            <div
                                class="absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-black/60 pointer-events-none">
                            </div>
                        </div>
                    </div>

                    <button onclick="spin()" id="spin-btn"
                        class="w-full max-w-sm md:max-w-md py-6 md:py-8 rounded-2xl md:rounded-[2rem] bg-gradient-to-r from-yellow-500 to-yellow-600 text-slate-950 font-black text-2xl md:text-4xl shadow-xl hover:scale-[1.02] active:scale-95 transition-all uppercase italic tracking-tighter disabled:opacity-30 disabled:grayscale ring-4 ring-yellow-500/20">
                        –ö–†–£–¢–ò–¢–ò –õ–ò–ú–û–ù
                    </button>

                    <div id="win-overlay" class="hidden mt-6 md:mt-10 text-center animate-win">
                        <p class="text-2xl md:text-4xl font-black text-yellow-400 italic" id="win-text">–í–ï–õ–ò–ö–ò–ô –í–ò–ì–†–ê–®!
                        </p>
                    </div>

                    <p id="no-spins-msg" class="hidden mt-6 text-red-500 font-black text-xl animate-pulse">
                        –ù–µ–º–∞—î —Å–ø—ñ–Ω—ñ–≤! –ó–∞–¥–æ–Ω–∞—Ç—å –¥–ª—è –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è
                    </p>
                </div>

                <div class="mt-12 w-full grid grid-cols-5 gap-3 max-w-2xl px-4">
                    <div class="glass p-4 rounded-xl text-center border border-white/5">
                        <span class="text-2xl block mb-1">üçã</span><span
                            class="text-[8px] font-bold text-slate-500">100</span>
                    </div>
                    <div class="glass p-4 rounded-xl text-center border border-white/5 opacity-50">
                        <span class="text-2xl block mb-1">üçí</span><span
                            class="text-[8px] font-bold text-slate-500">10</span>
                    </div>
                    <div class="glass p-4 rounded-xl text-center border border-white/5 opacity-50">
                        <span class="text-2xl block mb-1">üçâ</span><span
                            class="text-[8px] font-bold text-slate-500">30</span>
                    </div>
                    <div class="glass p-4 rounded-xl text-center border border-white/5 opacity-50">
                        <span class="text-2xl block mb-1">üíé</span><span
                            class="text-[8px] font-bold text-slate-500">50</span>
                    </div>
                    <div class="glass p-4 rounded-xl text-center border border-white/5 opacity-50">
                        <span class="text-2xl block mb-1">7Ô∏è‚É£</span><span
                            class="text-[8px] font-bold text-slate-500">70</span>
                    </div>
                </div>

                <!-- Rules & Donation Section -->
                <div class="mt-12 md:mt-16 w-full max-w-4xl px-2 md:px-0">
                    <div
                        class="glass p-8 md:p-12 rounded-3xl md:rounded-[3rem] border-2 border-yellow-500/10 shadow-3xl text-center">
                        <h3 class="text-3xl font-black italic text-yellow-500 mb-6 uppercase tracking-tighter">
                            –ü–Ü–î–¢–†–ò–ú–ê–¢–ò –ó–ë–Ü–†</h3>
                        <p class="text-slate-300 mb-10 max-w-2xl mx-auto leading-relaxed">
                            –í—Å—ñ –≤–∏–≥—Ä–∞—à—ñ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ, –∞–ª–µ –∫–æ–∂–µ–Ω —Ç–≤—ñ–π –¥–æ–Ω–∞—Ç ‚Äî —Ü–µ —Ä–µ–∞–ª—å–Ω–∞ –∑–±—Ä–æ—è –¥–ª—è –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤.
                            –ö—Ä—É—Ç–∏ –ª–∏–º–æ–Ω–∏, –∑–∞–±–∏–≤–∞–π –±–∞–ª–∏ —Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥—å –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –Ω–∞ –±–∞–Ω–∫—É!
                        </p>

                        <a href="https://send.monobank.ua/–≤–∞—à–∞_–±–∞–Ω–∫–∞" target="_blank"
                            class="inline-block bg-yellow-500 text-slate-950 font-black px-12 py-6 rounded-2xl text-xl hover:scale-105 transition-all shadow-2xl uppercase tracking-tight">
                            –ü–û–°–ò–õ–ê–ù–ù–Ø –ù–ê –ë–ê–ù–ö–£ üêà‚¨õ
                        </a>

                        <div
                            class="mt-16 grid grid-cols-1 md:grid-cols-2 gap-8 text-left border-t border-white/5 pt-16">
                            <div class="space-y-4">
                                <div class="flex items-start gap-4">
                                    <div
                                        class="w-8 h-8 rounded-full bg-yellow-500/20 flex items-center justify-center font-black text-yellow-400 shrink-0">
                                        1</div>
                                    <p class="text-slate-300 leading-relaxed">**–õ–∏–º–æ–Ω (üçã)** ‚Äî –≥–æ–ª–æ–≤–Ω–∏–π —Å–∏–º–≤–æ–ª. 3 –ª–∏–º–æ–Ω–∏
                                        –¥–∞—é—Ç—å –Ω–∞–π–±—ñ–ª—å—à–∏–π –±–æ–Ω—É—Å!</p>
                                </div>
                                <div class="flex items-start gap-4">
                                    <div
                                        class="w-8 h-8 rounded-full bg-yellow-500/20 flex items-center justify-center font-black text-yellow-400 shrink-0">
                                        2</div>
                                    <p class="text-slate-300 leading-relaxed">–í–∞—Ä—Ç—ñ—Å—Ç—å: üçã(100), 7Ô∏è‚É£(70), üíé(50),
                                        üçâ(30), üçí(10).</p>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div class="flex items-start gap-4">
                                    <div
                                        class="w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center font-black text-blue-400 shrink-0">
                                        3</div>
                                    <p class="text-slate-300 leading-relaxed font-bold italic">–ó–∞—Ä—è–¥–∂–∞–π –Ω–∞ –ø–µ—Ä–µ–º–æ–≥—É
                                        –∫–æ–∂–Ω–∏–º –∫–ª—ñ–∫–æ–º!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Secret Admin Logic (Footer Hidden) -->
        <div id="admin-trigger" onclick="adminLogin()"
            class="mt-auto py-10 opacity-5 hover:opacity-50 transition-all cursor-default text-[10px] tracking-widest text-slate-600">
            ¬© 2026 CASINO INFRASTRUCTURE ‚Ä¢ REALTIME ENABLED
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://huhilljlthphkmvgyqlv.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1aGlsbGpsdGhwaGttdmd5cWx2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4NzY5NzYsImV4cCI6MjA4NzQ1Mjk3Nn0.OgAcEX5nmEAHwONTLEhF5t_2v6yOdTYIWs5cy9tBpBw';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        const EMOJIS = ['üçã', 'üçí', 'üçâ', 'üíé', '7Ô∏è‚É£'];
        const SYMBOL_VALUES = { 'üçã': 100, '7Ô∏è‚É£': 70, 'üíé': 50, 'üçâ': 30, 'üçí': 10 };

        let currentUser = null;
        let isSpinning = false;

        // Audio Synth
        const AudioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSfx(freq, type, duration, vol) {
            const osc = AudioCtx.createOscillator();
            const gain = AudioCtx.createGain();
            osc.connect(gain).connect(AudioCtx.destination);
            osc.frequency.value = freq; osc.type = type;
            gain.gain.setValueAtTime(vol, AudioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, AudioCtx.currentTime + duration);
            osc.start(); osc.stop(AudioCtx.currentTime + duration);
        }

        const $ = id => document.getElementById(id);

        // Handle Enter key for login
        $('username-input').addEventListener('keypress', e => {
            if (e.key === 'Enter') handleLogin();
        });

        // Auto-login on mount
        window.addEventListener('load', async () => {
            const savedUser = localStorage.getItem('casino_username');
            if (savedUser) {
                console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤—Ö—ñ–¥ –¥–ª—è:', savedUser);
                await performLogin(savedUser);
            }
        });

        async function handleLogin() {
            const usernameValue = $('username-input').value.trim();
            if (!usernameValue) return;
            await performLogin(usernameValue);
        }

        async function performLogin(usernameValue) {
            $('login-btn').innerText = '–í–•–Ü–î...';
            $('login-btn').disabled = true;

            try {
                // IMPORTANT: Columns must be username, spins, points
                let { data, error } = await supabaseClient.from('profiles').select('*').eq('username', usernameValue);
                if (error) throw error;

                if (!data || data.length === 0) {
                    const { data: newUser, error: createError } = await supabaseClient
                        .from('profiles').insert([{ username: usernameValue, spins: 0, points: 0 }]).select();
                    if (createError) {
                        console.error('Create Error:', createError);
                        throw createError;
                    }
                    data = newUser;
                }

                currentUser = data[0];
                localStorage.setItem('casino_username', currentUser.username);
                switchToGame();
                initRealtime();
            } catch (err) {
                console.error('Login Failure:', err);
                localStorage.removeItem('casino_username'); // Clean up on any error (like user deleted from DB)
                $('auth-status').innerText = '–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.';
                $('login-btn').innerText = '–ü–û–ß–ê–¢–ò –ì–†–£';
                $('login-btn').disabled = false;
                $('auth-screen').classList.remove('hidden');
                $('game-screen').classList.add('hidden'); // Ensure game is hidden if auto-login fails
            }
        }

        function logout() {
            localStorage.removeItem('casino_username');
            currentUser = null;
            location.reload(); // Simplest way to reset all state
        }

        function switchToGame() {
            $('auth-screen').classList.add('hidden');
            $('game-screen').classList.remove('hidden');
            updateUI();
            updateLeaderboard();
        }

        function updateUI() {
            if (!currentUser) return;
            $('display-username').innerText = currentUser.username;
            $('display-spins').innerText = currentUser.spins;
            $('display-points').innerText = currentUser.points;

            const btn = $('spin-btn');
            const msg = $('no-spins-msg');

            if (currentUser.spins <= 0) {
                btn.disabled = true;
                msg.classList.remove('hidden');
            } else {
                btn.disabled = false;
                msg.classList.add('hidden');
            }
        }

        function initRealtime() {
            // Subscribe to any changes in profiles table for leaderboard and personal sync
            supabaseClient.channel('profiles-sync')
                .on('postgres_changes', { event: '*', table: 'profiles' }, (payload) => {
                    if (payload.new && payload.new.username === currentUser.username) {
                        currentUser = payload.new;
                        updateUI();
                    }
                    updateLeaderboard();
                })
                .subscribe();
        }

        async function updateLeaderboard() {
            const { data } = await supabaseClient.from('profiles').select('username, points').order('points', { ascending: false }).limit(10);
            if (data) {
                $('leaderboard-list').innerHTML = data.map((u, i) => `
                    <div class="flex justify-between items-center p-3 rounded-xl border border-white/5 transition-all ${u.username === currentUser.username ? 'bg-purple-500/20 shadow-lg border-purple-500/50' : 'bg-white/5'}">
                        <div class="flex items-center gap-2 overflow-hidden">
                            <span class="text-[10px] font-black opacity-40 italic">#${i + 1}</span>
                            <span class="font-bold text-sm truncate">${u.username}</span>
                        </div>
                        <span class="font-black text-yellow-500 text-sm tracking-tighter">${u.points.toLocaleString()}</span>
                    </div>
                `).join('');
            }
        }

        async function spin() {
            if (isSpinning || currentUser.spins <= 0) return;
            isSpinning = true;
            $('win-overlay').classList.add('hidden');

            // 1. CRITICAL: Deduct spin in DB first
            const { error: spinErr } = await supabaseClient.from('profiles').update({ spins: currentUser.spins - 1 }).eq('username', currentUser.username);

            if (spinErr) {
                console.error('Spin deduction failed:', spinErr);
                isSpinning = false;
                return;
            }

            // Start Audio
            playSfx(120, 'square', 0.4, 0.1);

            const reels = [$('reel-1'), $('reel-2'), $('reel-3')];
            const result = [EMOJIS[Math.floor(Math.random() * 5)], EMOJIS[Math.floor(Math.random() * 5)], EMOJIS[Math.floor(Math.random() * 5)]];

            // Animation Loop (2 seconds total)
            const startTime = Date.now();
            const duration = 2000;

            const timer = setInterval(() => {
                const elapsed = Date.now() - startTime;

                reels.forEach((reel, i) => {
                    if (elapsed < duration - (i * 500)) {
                        reel.innerText = EMOJIS[Math.floor(Math.random() * 5)];
                        reel.classList.add('blur-effect');
                        if (Math.random() > 0.8) playSfx(200 + (i * 100), 'sine', 0.05, 0.05);
                    } else {
                        reel.innerText = result[i];
                        reel.classList.remove('blur-effect');
                    }
                });

                if (elapsed >= duration + 200) {
                    clearInterval(timer);
                    awardPoints(result);
                }
            }, 80);
        }

        async function awardPoints(res) {
            isSpinning = false;

            let totalEarned = SYMBOL_VALUES[res[0]] + SYMBOL_VALUES[res[1]] + SYMBOL_VALUES[res[2]];
            const isJackpot = res[0] === res[1] && res[1] === res[2];

            if (isJackpot) {
                totalEarned *= 2;

                // Jackpot Celebration
                confetti({ particleCount: 200, spread: 70, origin: { y: 0.6 }, colors: ['#a855f7', '#fbbf24', '#22d3ee'] });
                playSfx(440, 'triangle', 0.6, 0.2);
                setTimeout(() => playSfx(554, 'triangle', 0.6, 0.2), 100);
                setTimeout(() => playSfx(659, 'triangle', 0.8, 0.2), 200);

                $('win-text').innerText = `–î–ñ–ï–ö–ü–û–¢! X2 –ë–û–ù–£–°: +${totalEarned} –ë–ê–õ–Ü–í!`;
            } else {
                playSfx(200, 'sine', 0.1, 0.05);
                $('win-text').innerText = `–í–ò –ù–ê–ë–†–ê–õ–ò +${totalEarned} –ë–ê–õ–Ü–í!`;
            }

            $('win-overlay').classList.remove('hidden');

            // Update points in DB
            const { error: pointsErr } = await supabaseClient
                .from('profiles')
                .update({ points: currentUser.points + totalEarned })
                .eq('username', currentUser.username);

            if (pointsErr) console.error('Points increment failed:', pointsErr);
        }

        // Admin login removed - use admin.html
        function adminLogin() {
            window.location.href = 'admin.html';
        }
    </script>
</body>

</html>